@using EF = System.Data.Entity;

@{
    // Manually run the database initializer to ensure that the Users table
    // exists before WebSecurity.InitializeDatabaseConnection is run.
    var initializer = new EF.MigrateDatabaseToLatestVersion<Consumer.Models.ConsumerContext, Consumer.Migrations.Configuration>();
    EF.Database.SetInitializer(initializer);
    initializer.InitializeDatabase(new Consumer.Models.ConsumerContext());
    
    
    WebSecurity.InitializeDatabaseConnection("DefaultConnection", "Users", "UserId", "UserName", autoCreateTables: true);
    if (!Roles.RoleExists(Consumer.Models.UserRoles.TeacherRole))
    {
        Roles.CreateRole(Consumer.Models.UserRoles.TeacherRole);
    }
    if (!Roles.RoleExists(Consumer.Models.UserRoles.StudentRole))
    {
        Roles.CreateRole(Consumer.Models.UserRoles.StudentRole);
    }
}
