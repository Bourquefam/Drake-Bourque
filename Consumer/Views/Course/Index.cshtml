@model IEnumerable<Consumer.Models.Course>

@{
    ViewBag.Title = "Courses";
}

<hgroup class="title">
    <h1>@ViewBag.Title.</h1>
    <h2>A list of all the courses in this system.</h2>
</hgroup>

@if (Model.Count() == 0)
{
    <p>
        There are no courses yet.
    </p>
} 
else 
{
    <table>
        <tr>
            <td><strong>Course</strong></td>
            <td><strong>Instructor</strong></td>
            <td></td>
        </tr>

    @foreach (var item in Model) {
        <tr>
            <td>
                @item.Title
            </td>
            <td>
                @item.Instructor.FullName
            </td>
            <td>
                @Html.ActionLink("Details", "Details", new { id = item.CourseId }, new { @class = "button" })
            @if (Roles.IsUserInRole(Consumer.Models.UserRoles.TeacherRole) && item.Instructor.UserId == WebSecurity.CurrentUserId)
            {
                @Html.ActionLink("Edit", "Edit", new { id = item.CourseId }, new { @class = "button" })
                @Html.ActionLink("Delete", "Delete", new { id = item.CourseId }, new { @class = "button" })
            }
            </td>
        </tr>
    }

    </table>
}

@if (Roles.IsUserInRole(Consumer.Models.UserRoles.TeacherRole))
{
    <p>
        @Html.ActionLink("Create Course", "Create", null, new { @class = "button" })
        @if (ViewBag.inBloomAccount != null)
        {
            @Html.ActionLink("Import inBloom Sections", "ImportInBloomSections", null, new { @class = "button" })
        }
    </p>
}
else
{
    <p>
        You must have the Teacher role to create or edit courses. To change your roles, visit your
        Profile page.
    </p>
}

